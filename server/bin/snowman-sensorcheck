#!/usr/bin/python
import datetime
import os
import sys

# Add the parent folder of the script to the path
scriptpath = os.path.realpath(__file__)
scriptdir = os.path.dirname(scriptpath)
parentdir = os.path.dirname(scriptdir)
sys.path.append(parentdir)

os.environ.setdefault("DJANGO_SETTINGS_MODULE", "srm.settings")
from core.models import Sensor

def main():
	for sensor in Sensor.objects.exclude(name="All").filter(autonomous=False).all():
		status = sensor.pingSensor()
		sensor.lastStatus = status['status']
		sensor.lastChecked = datetime.datetime.now()
		sensor.save()

if __name__ == '__main__':
	main()
